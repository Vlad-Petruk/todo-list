(()=>{"use strict";const t=(t,e,n,o,i)=>({title:t,description:e,dueDate:n,priority:o,complite:i});let e=[{id:"All todos",title:"All todos",todos:[t("Open me...","i know how you feel... but keep going, just one step at a time","11/12/12","top")]}];document.addEventListener("DOMContentLoaded",(function(){(()=>{const n=document.getElementById("navigation"),o=document.getElementById("content"),i=document.getElementById("modal"),d=document.getElementById("modal-content"),l=a("div","section-title",null,null,o);function c(){n.innerHTML="",a("button","create-project-btn",null,"Create project",n).addEventListener("click",(()=>{!function(){i.style.display="block",a("h2","modal-title",null,"Section form",d);const t=a("form","todo-form",null,null,d),n=a("input","title","title",null,t,"Title");a("button","section-submit",null,"Submit",t,"Submit").addEventListener("click",(()=>{let t=((t,e)=>{const n=[];return{id:t,title:e,todos:n,addTodo:t=>{n.push(t)},deleteTodo:t=>{let e=n.indexOf(t);n.splice(e,1)}}})(n.value,n.value);console.log(t),e.push(t),p(),c(),s(e.find((t=>t.id===n.value)))})),r()}()})),e.forEach((t=>{const e=document.createElement("div");e.classList.add("nav-element"),"completed"===t.id&&e.classList.add("project-separator"),e.textContent=t.title,e.addEventListener("click",(()=>s(t))),n.appendChild(e)}))}function s(n){const c=o.children;for(const t of c)"section-title"!==t.id&&(t.innerHTML="");const v=document.createElement("div");l.innerHTML="",l.innerHTML=n.title;const h=document.createElement("button");if(h.type="button",h.innerHTML="Add Todo",h.classList.add("add-todo-button"),v.appendChild(h),h.addEventListener("click",(()=>{!function(){const n=document.createElement("h2");n.innerHTML="Create Todo",d.appendChild(n),i.style.display="block";const o=document.createElement("form");o.id="todo-form";const c=a("input","title","title",null,o,"Title"),u=a("textarea","description","description",null,o,"Description"),v=a("input","dueDate","dueDate",null,o,"Due Date"),h=a("select","priority","priority",null,o,"Priority",[{value:"low",text:"Low"},{value:"medium",text:"Medium"},{value:"top",text:"Top"}]);a("button","todo-submit",null,"Submit",o,"Submit").addEventListener("click",(()=>{let n=t(c.value,u.value,v.value,h.value);console.log(n),"All todos"===l.innerHTML||(console.log(l.textContent),f(l.textContent,n)),f("All todos",n),p(),s(e.find((t=>t.id===l.innerHTML)))})),d.appendChild(o),r(),m()}()})),0===n.todos.length){const t=document.createElement("p");t.textContent="No todos for this section.",v.appendChild(t)}else n.todos.forEach(((t,e)=>{const n=document.createElement("div");n.classList.add("todo");const o=document.createElement("input");o.type="checkbox",o.checked=t.complete,o.addEventListener("change",(()=>{t.complete=o.checked,o.checked?i.classList.add("crossed-out"):i.classList.remove("crossed-out")}));const i=document.createElement("div");i.textContent=t.title,i.addEventListener("click",(()=>u(t))),n.appendChild(o),n.appendChild(i),v.appendChild(n)}));o.appendChild(v)}function a(t,e,n,o,i,d,l){const c=document.createElement(t);if(c.setAttribute("name",n),c.setAttribute("id",e),"button"!==t){const t=document.createElement("label");t.setAttribute("for",e),t.textContent=d,i.appendChild(t)}if(c.innerHTML=o,l)for(const t of l){const e=document.createElement("option");e.value=t.value,e.textContent=t.text,c.appendChild(e)}return i.appendChild(c),c}function u(t,e){d.innerHTML=`\n      <p>Todo Details:</p>\n      <p>Title: ${t.title}</p>\n      <p>Descrption: ${t.description||"No details available"}</p>\n      <p>Due date: ${t.dueDate}<p>\n      <p>Priorty: ${t.priority}\n      `,i.style.display="block",r(),m()}function r(){const t=document.createElement("div");t.className="close",t.innerHTML="&times;",t.addEventListener("click",(()=>p())),d.appendChild(t)}function p(){i.style.display="none",d.innerHTML=""}function m(){const t=document.createElement("button");t.textContent="Update",t.addEventListener("click",(()=>(index,void p()))),d.appendChild(t)}function f(t,n){e.find((e=>e.id===t)).todos.push(n),c(),s(e.find((e=>e.id===t)))}c(),s(e.find((t=>"All todos"===t.id)))})()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUtyQixtQkFFbkJVLEVBQU1NLE1BQU1DLFFBQVUsUUFFdEJrQixJQUNBdUIsR0FDRixDQUVBLFNBQVN2QixJQUVQLE1BQU00QyxFQUFjMUUsU0FBU2tDLGNBQWMsT0FDM0N3QyxFQUFZQyxVQUFZLFFBQ3hCRCxFQUFZaEUsVUFBWSxVQUd4QmdFLEVBQVl6RSxpQkFBaUIsU0FBUyxJQUFNeUIsTUFHNUNwQixFQUFhZ0MsWUFBWW9DLEVBQzNCLENBSUEsU0FBU2hELElBQ1ByQixFQUFNTSxNQUFNQyxRQUFVLE9BRXRCTixFQUFhSSxVQUFZLEVBRTNCLENBRUEsU0FBUzJDLElBRVAsTUFBTXVCLEVBQVk1RSxTQUFTa0MsY0FBYyxVQUN6QzBDLEVBQVV2QyxZQUFjLFNBQ3hCdUMsRUFBVTNFLGlCQUFpQixTQUFTLEtBQXdCd0QsV0FTNUQvQixPQVJBcEIsRUFBYWdDLFlBQVlzQyxFQUMzQixDQVlBLFNBQVN4QixFQUFnQnlCLEVBQVc3RCxHQUNsQ25CLEVBQVMrQixNQUFLQyxHQUFXQSxFQUFRL0IsS0FBTytFLElBQVc5RSxNQUFNa0IsS0FBS0QsR0FHOURQLElBQ0FrQixFQUFZOUIsRUFBUytCLE1BQUtDLEdBQVdBLEVBQVEvQixLQUFPK0UsSUFDdEQsQ0FHRnBFLElBQ0FrQixFQUFZOUIsRUFBUytCLE1BQUtDLEdBQTBCLGNBQWZBLEVBQVEvQixLQVE3QyxFQzVQRWdGLEVBRUQsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL1VJLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTZWN0aW9uRmFjdG9yeSA9IChpZCwgdGl0bGUpID0+IHtcclxuICAgIGNvbnN0IHRvZG9zID0gW107XHJcbiAgXHJcbiAgICBjb25zdCBhZGRUb2RvID0gKHRvZG8pID0+IHtcclxuICAgICAgdG9kb3MucHVzaCh0b2RvKTtcclxuICAgIC8vICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGRlbGV0ZVRvZG8gPSAodG9kbykgPT4ge1xyXG4gICAgICBsZXQgdG9kb0luZGV4ID0gdG9kb3MuaW5kZXhPZih0b2RvKVxyXG4gICAgICB0b2Rvcy5zcGxpY2UodG9kb0luZGV4LDEpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICB0b2RvcyxcclxuICAgICAgYWRkVG9kbyxcclxuICAgICAgZGVsZXRlVG9kbyxcclxuICAgIH07XHJcbiAgfTtcclxuXHJcbmNvbnN0IFRvZG9GYWN0b3J5ID0gKHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHksY29tcGxpdGUpID0+IHtcclxuICBjb21wbGl0ZTogZmFsc2U7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0aXRsZSxcclxuICAgICAgICBkZXNjcmlwdGlvbiwgXHJcbiAgICAgICAgZHVlRGF0ZSwgXHJcbiAgICAgICAgcHJpb3JpdHksXHJcbiAgICAgICAgY29tcGxpdGVcclxuICAgIH07XHJcbn1cclxuXHJcblxyXG5cclxuIGV4cG9ydCB7U2VjdGlvbkZhY3RvcnksIFRvZG9GYWN0b3J5fSIsImltcG9ydCB7IFRvZG9GYWN0b3J5LCBTZWN0aW9uRmFjdG9yeSB9IGZyb20gXCIuL2ZhY3Rvcmllc1wiO1xyXG5cclxuLy8gTWF5YmUgdHJ5IHRvIHdvcmsgd2l0aCB0aGlzIGZ1bmN0aW9uIGFsbCB0aGUgd2F5LCB3aXRoIHNlY3Rpb25zKHRvZGF5LHdlZWssIG1vbnRoKSBcclxuLy8gbWF5YmUgdHJlIHRvIHVwZGF0ZSBmdW5jdGlvbiB0byBiZSBhYmxlIHRvIGFkZCB0b2RvcyBhbmQgY3JlYXRlIGFuZCBhZGQgcHJvamVjdHMgYXMgd2VsbFxyXG5cclxubGV0IGRlZmF1bHRUb2RvID0gVG9kb0ZhY3RvcnkoJ09wZW4gbWUuLi4nLCdpIGtub3cgaG93IHlvdSBmZWVsLi4uIGJ1dCBrZWVwIGdvaW5nLCBqdXN0IG9uZSBzdGVwIGF0IGEgdGltZScsJzExLzEyLzEyJywndG9wJywpO1xyXG4gXHJcbi8vIEluaXRpYWwgc2FtcGxlIGRhdGEgZm9yIG5hdmlnYXRpb24gaXRlbXMgYW5kIGNvcnJlc3BvbmRpbmcgY29udGVudFxyXG5sZXQgc2VjdGlvbnMgPSBbXHJcbiAgeyBpZDogJ0FsbCB0b2RvcycsIHRpdGxlOiAnQWxsIHRvZG9zJywgdG9kb3M6IFtkZWZhdWx0VG9kb10gfSxcclxuXTtcclxuXHJcbmNvbnN0IGRvbUxvYWRlciA9ICgpID0+e1xyXG4gICAgY29uc3QgbmF2aWdhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZpZ2F0aW9uJyk7XHJcbiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKTtcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsJyk7XHJcbiAgICBjb25zdCBtb2RhbENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtY29udGVudCcpO1xyXG4gICAgY29uc3Qgc2VjdGlvblRpdGxlID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudCgnZGl2JywgJ3NlY3Rpb24tdGl0bGUnLG51bGwsIG51bGwsIGNvbnRlbnQpXHJcbiAgICBcclxuXHJcbiAgICAvLyBGdW5jdGlvbiB0byByZW5kZXIgbmF2aWdhdGlvbiBpdGVtc1xyXG4gICAgZnVuY3Rpb24gcmVuZGVyTmF2aWdhdGlvbigpIHtcclxuICAgICAgbmF2aWdhdGlvbi5pbm5lckhUTUwgPSAnJztcclxuICAgICAgY29uc3QgY3JlYXRlUHJvamVjdEJ0biA9IGNyZWF0ZUFuZEFwcGVuZEVsZW1lbnQoJ2J1dHRvbicsICdjcmVhdGUtcHJvamVjdC1idG4nLCBudWxsLCAnQ3JlYXRlIHByb2plY3QnLCBuYXZpZ2F0aW9uKTtcclxuICAgICAgY3JlYXRlUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XHJcbiAgICAgICAgb3BlblNlY3Rpb25DcmVhdGVNb2RhbCgpO1xyXG4gICAgICB9KVxyXG4gICAgICBzZWN0aW9ucy5mb3JFYWNoKHNlY3Rpb24gPT4ge1xyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ25hdi1lbGVtZW50JylcclxuICAgICAgICBpZiAoc2VjdGlvbi5pZCA9PT0gJ2NvbXBsZXRlZCcpe1xyXG4gICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LXNlcGFyYXRvcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpdGVtLnRleHRDb250ZW50ID0gc2VjdGlvbi50aXRsZTtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2hvd0NvbnRlbnQoc2VjdGlvbikpO1xyXG4gICAgICAgIG5hdmlnYXRpb24uYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLy8gRnVuY3Rpb24gdG8gc2hvdyBjb250ZW50IGZvciBhIHNlbGVjdGVkIHNlY3Rpb25cclxuICAgIGZ1bmN0aW9uIHNob3dDb250ZW50KHNlY3Rpb24pIHtcclxuICAgICAgY29uc3QgY2hpbGRyZW4gPSBjb250ZW50LmNoaWxkcmVuO1xyXG5cclxuICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgaWYgKGNoaWxkLmlkICE9PSAnc2VjdGlvbi10aXRsZScpIHtcclxuICAgICAgICAgICAgICBjaGlsZC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAvLyBUaXRsZVxyXG4gICAgICBzZWN0aW9uVGl0bGUuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgIHNlY3Rpb25UaXRsZS5pbm5lckhUTUwgPSBzZWN0aW9uLnRpdGxlO1xyXG4gICAgICAvL0J1dHRvbiBcclxuICAgICAgY29uc3QgYWRkVG9kb0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICBhZGRUb2RvQnV0dG9uLnR5cGU9ICdidXR0b24nO1xyXG4gICAgICBhZGRUb2RvQnV0dG9uLmlubmVySFRNTCA9IFwiQWRkIFRvZG9cIjtcclxuICAgICAgYWRkVG9kb0J1dHRvbi5jbGFzc0xpc3QuYWRkKCdhZGQtdG9kby1idXR0b24nKVxyXG4gICAgICBjb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZChhZGRUb2RvQnV0dG9uKTtcclxuICAgICAgYWRkVG9kb0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKCk9PntcclxuICAgICAgICBvcGVuVG9kb0NyZWF0ZU1vZGFsKCk7XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBjb250ZW50IGluIHRoZSBzZWN0aW9uXHJcbiAgICAgIGlmIChzZWN0aW9uLnRvZG9zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnN0IG5vVG9kb3NNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIG5vVG9kb3NNZXNzYWdlLnRleHRDb250ZW50ID0gJ05vIHRvZG9zIGZvciB0aGlzIHNlY3Rpb24uJztcclxuICAgICAgICBjb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZChub1RvZG9zTWVzc2FnZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIHRoZSBhcnJheSBhbmQgY3JlYXRlIGVsZW1lbnRzIGZvciBlYWNoIHRvZG8gaXRlbVxyXG4gICAgICAgIHNlY3Rpb24udG9kb3MuZm9yRWFjaCgodG9kbywgaW5kZXgpID0+IHtcclxuICAgICAgICAgIGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIHRvZG9Db250YWluZXIuY2xhc3NMaXN0LmFkZCgndG9kbycpXHJcbiAgICAgICAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgICBjaGVja2JveC50eXBlID0gJ2NoZWNrYm94JztcclxuICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSB0b2RvLmNvbXBsZXRlO1xyXG5cclxuICAgICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcclxuICAgICAgICAgICAgdG9kby5jb21wbGV0ZSA9IGNoZWNrYm94LmNoZWNrZWQ7XHJcbiAgICAgICAgICAgIC8vIFlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgbG9naWMgaGVyZSwgc3VjaCBhcyB1cGRhdGluZyB0aGUgVUkgb3Igc2F2aW5nIHRvIHN0b3JhZ2VcclxuICAgICAgICAgICAgaWYgKGNoZWNrYm94LmNoZWNrZWQpe1xyXG4gICAgICAgICAgICB0b2RvRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjcm9zc2VkLW91dCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRvZG9FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Nyb3NzZWQtb3V0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCB0b2RvRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICB0b2RvRWxlbWVudC50ZXh0Q29udGVudCA9IHRvZG8udGl0bGU7IFxyXG4gICAgICAgICAgdG9kb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBvcGVuVG9kb0RldGFpbHNNb2RhbCh0b2RvLCBpbmRleCkpO1xyXG5cclxuICAgICAgICAgIHRvZG9Db250YWluZXIuYXBwZW5kQ2hpbGQoY2hlY2tib3gpO1xyXG4gICAgICAgICAgdG9kb0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvRWxlbWVudCk7XHJcbiAgICAgICAgICBjb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZCh0b2RvQ29udGFpbmVyKVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgY29udGVudC5hcHBlbmRDaGlsZChjb250ZW50RWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhbmQgYXBwZW5kIGVsZW1lbnRzXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVBbmRBcHBlbmRFbGVtZW50KHR5cGUsIGlkLCBuYW1lLCBpbm5lckhUTUwsIHBhcmVudEVsLCBsYWJlbFRleHQsIG9wdGlvbnMpIHtcclxuICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XHJcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBuYW1lKTtcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpZCk7XHJcblxyXG4gICAgICBpZiAodHlwZSAhPT0gXCJidXR0b25cIikge1xyXG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgaWQpO1xyXG4gICAgICAgICAgbGFiZWwudGV4dENvbnRlbnQgPSBsYWJlbFRleHQ7XHJcbiAgICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZChsYWJlbCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xyXG5cclxuICAgICAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgICAgICAgICAgICAgIG9wdGlvbkVsZW1lbnQudmFsdWUgPSBvcHRpb24udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gb3B0aW9uLnRleHQ7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG9wdGlvbkVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZChlbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvcGVuU2VjdGlvbkNyZWF0ZU1vZGFsICgpIHtcclxuICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgIGNvbnN0IG1vZGFsVGl0bGUgPSBjcmVhdGVBbmRBcHBlbmRFbGVtZW50KCdoMicsICdtb2RhbC10aXRsZScsIG51bGwsICdTZWN0aW9uIGZvcm0nLCBtb2RhbENvbnRlbnQpO1xyXG4gICAgICBjb25zdCBzZWN0aW9uRm9ybSA9IGNyZWF0ZUFuZEFwcGVuZEVsZW1lbnQoJ2Zvcm0nLCAndG9kby1mb3JtJywgbnVsbCwgbnVsbCwgbW9kYWxDb250ZW50KTtcclxuICAgICAgY29uc3Qgc2VjdGlvblRpdGxlID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudCgnaW5wdXQnLCAndGl0bGUnLCAndGl0bGUnLCBudWxsLCBzZWN0aW9uRm9ybSwgJ1RpdGxlJyk7XHJcblxyXG4gICAgICBjb25zdCB0b2RvU3VibWl0QnRuID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudChcImJ1dHRvblwiLCBcInNlY3Rpb24tc3VibWl0XCIsIG51bGwsICdTdWJtaXQnLCBzZWN0aW9uRm9ybSwgXCJTdWJtaXRcIik7XHJcbiAgICBcclxuICAgICAgdG9kb1N1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCk9PntcclxuICAgICAgICBsZXQgbmV3U2VjdGlvbiA9IFNlY3Rpb25GYWN0b3J5KHNlY3Rpb25UaXRsZS52YWx1ZSwgc2VjdGlvblRpdGxlLnZhbHVlKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhuZXdTZWN0aW9uKTtcclxuICAgICAgICBzZWN0aW9ucy5wdXNoKG5ld1NlY3Rpb24pO1xyXG4gICAgICAgIGNsb3NlTW9kYWwoKTtcclxuICAgICAgICByZW5kZXJOYXZpZ2F0aW9uKClcclxuICAgICAgICBzaG93Q29udGVudChzZWN0aW9ucy5maW5kKHNlY3Rpb24gPT4gc2VjdGlvbi5pZCA9PT0gc2VjdGlvblRpdGxlLnZhbHVlKSlcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNyZWF0ZUNsb3NlTW9kYWxCdG4oKTtcclxuICAgIH1cclxuICAgIC8vIGZ1bmN0aW9uIHBvcHVsYXRlU2VjdGlvbihzZWN0aW9uSWQsIHByb2plY3QsIHRvZG8pXHJcbiAgICBmdW5jdGlvbiBvcGVuVG9kb0NyZWF0ZU1vZGFsKCl7XHJcbiAgICAgIGNvbnN0IG1vZGFsVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICBtb2RhbFRpdGxlLmlubmVySFRNTCA9ICdDcmVhdGUgVG9kbyc7XHJcbiAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChtb2RhbFRpdGxlKTtcclxuICAgICAgLy8gSGVyZSBzaG91bGQgYmUgZm9ybSBlbGVtZW50IHdpdGggc3VibWl0QWxsIHRvZG9zIGJ1dHRvblxyXG4gICAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgLy8gY29uc3QgdG9kb0Zvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kby1mb3JtJyk7XHJcbiAgICAgIGNvbnN0IHRvZG9Gb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgICAgIHRvZG9Gb3JtLmlkID0gXCJ0b2RvLWZvcm1cIjtcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBhbmQgYXBwZW5kIGVsZW1lbnRzIGZvciBUaXRsZSwgRGVzY3JpcHRpb24sIER1ZSBEYXRlLCBQcmlvcml0eSwgYW5kIFN1Ym1pdCBidXR0b25cclxuICAgICAgY29uc3QgdG9kb1RpdGxlID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudChcImlucHV0XCIsIFwidGl0bGVcIiwgXCJ0aXRsZVwiLCBudWxsLCB0b2RvRm9ybSwgXCJUaXRsZVwiKTtcclxuICAgICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudChcInRleHRhcmVhXCIsIFwiZGVzY3JpcHRpb25cIiwgXCJkZXNjcmlwdGlvblwiLCBudWxsLCB0b2RvRm9ybSwgXCJEZXNjcmlwdGlvblwiKTtcclxuICAgICAgY29uc3QgdG9kb0R1ZURhdGUgPSBjcmVhdGVBbmRBcHBlbmRFbGVtZW50KFwiaW5wdXRcIiwgXCJkdWVEYXRlXCIsIFwiZHVlRGF0ZVwiLCBudWxsLCB0b2RvRm9ybSwgXCJEdWUgRGF0ZVwiKTtcclxuICAgICAgY29uc3QgdG9kb1ByaW9yaXR5ID0gY3JlYXRlQW5kQXBwZW5kRWxlbWVudChcInNlbGVjdFwiLCBcInByaW9yaXR5XCIsIFwicHJpb3JpdHlcIiwgbnVsbCwgdG9kb0Zvcm0sIFwiUHJpb3JpdHlcIiwgW1xyXG4gICAgICAgICAgeyB2YWx1ZTogXCJsb3dcIiwgdGV4dDogXCJMb3dcIiB9LFxyXG4gICAgICAgICAgeyB2YWx1ZTogXCJtZWRpdW1cIiwgdGV4dDogXCJNZWRpdW1cIiB9LFxyXG4gICAgICAgICAgeyB2YWx1ZTogXCJ0b3BcIiwgdGV4dDogXCJUb3BcIiB9LFxyXG4gICAgICBdKTtcclxuICAgICAgY29uc3QgdG9kb1N1Ym1pdEJ0biA9IGNyZWF0ZUFuZEFwcGVuZEVsZW1lbnQoXCJidXR0b25cIiwgXCJ0b2RvLXN1Ym1pdFwiLCBudWxsLCAnU3VibWl0JywgdG9kb0Zvcm0sIFwiU3VibWl0XCIpO1xyXG4gICAgICB0b2RvU3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xyXG4gICAgICAgIGxldCBuZXdUb2RvID0gVG9kb0ZhY3RvcnkodG9kb1RpdGxlLnZhbHVlLCB0b2RvRGVzY3JpcHRpb24udmFsdWUsIHRvZG9EdWVEYXRlLnZhbHVlLHRvZG9Qcmlvcml0eS52YWx1ZSk7XHJcbiAgICAgICAgY29uc29sZS5sb2cobmV3VG9kbyk7XHJcbiAgICAgICAgLy8gaSB3YW50IGhlcmUgdG8gYmUgYWJsZSB0byBjcmVhdGUgdG9kbyBpbiBzZWN0aW9uIHRoYXQgaSB3YW50XHJcbiAgICAgICAgLy8gbWF5YmUgdGhyb3VndGggbW9kYWxUaXRsZSDRgtC40L/RgyBpZiBjb250ZW50Y2hpbGQgaXMgbm8gbW9kYWxUaXR0ZSB7Y29udGVudC5pbm5lcmh0bWw9PT0gJyd9XHJcbiAgICAgICAgaWYoc2VjdGlvblRpdGxlLmlubmVySFRNTCA9PT0gJ0FsbCB0b2RvcycpIHtcclxuICAgICAgICAgIHBvcHVsYXRlU2VjdGlvbignQWxsIHRvZG9zJyxuZXdUb2RvKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coc2VjdGlvblRpdGxlLnRleHRDb250ZW50KVxyXG4gICAgICAgICAgcG9wdWxhdGVTZWN0aW9uKHNlY3Rpb25UaXRsZS50ZXh0Q29udGVudCwgbmV3VG9kbyk7XHJcbiAgICAgICAgICBwb3B1bGF0ZVNlY3Rpb24oJ0FsbCB0b2RvcycsbmV3VG9kbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHBvcHVsYXRlU2VjdGlvbihzZWN0aW9uVGl0bGUuaW5uZXJIVE1MLCBuZXdUb2RvKVxyXG4gICAgICAgIGNsb3NlTW9kYWwoKTtcclxuICAgICAgICBzaG93Q29udGVudChzZWN0aW9ucy5maW5kKHNlY3Rpb24gPT4gc2VjdGlvbi5pZCA9PT0gc2VjdGlvblRpdGxlLmlubmVySFRNTCkpO1xyXG4gICAgICB9KVxyXG4gICAgICBtb2RhbENvbnRlbnQuYXBwZW5kQ2hpbGQodG9kb0Zvcm0pO1xyXG4gIFxyXG4gICAgICBjcmVhdGVDbG9zZU1vZGFsQnRuKCk7XHJcbiAgICAgIGNyZWF0ZVVwZGF0ZU1vZGFsQnRuKCk7XHJcbiAgICB9XHJcbiAgICAvLyBGdW5jdGlvbiB0byBvcGVuIG1vZGFsIHdpdGggdG9kbyBkZXRhaWxzXHJcbiAgICBmdW5jdGlvbiBvcGVuVG9kb0RldGFpbHNNb2RhbCh0b2RvLCBpbmRleCkge1xyXG4gICAgICBtb2RhbENvbnRlbnQuaW5uZXJIVE1MID0gYFxyXG4gICAgICA8cD5Ub2RvIERldGFpbHM6PC9wPlxyXG4gICAgICA8cD5UaXRsZTogJHt0b2RvLnRpdGxlfTwvcD5cclxuICAgICAgPHA+RGVzY3JwdGlvbjogJHt0b2RvLmRlc2NyaXB0aW9uIHx8ICdObyBkZXRhaWxzIGF2YWlsYWJsZSd9PC9wPlxyXG4gICAgICA8cD5EdWUgZGF0ZTogJHt0b2RvLmR1ZURhdGV9PHA+XHJcbiAgICAgIDxwPlByaW9ydHk6ICR7dG9kby5wcmlvcml0eX1cclxuICAgICAgYDtcclxuICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgXHJcbiAgICAgIGNyZWF0ZUNsb3NlTW9kYWxCdG4oKTtcclxuICAgICAgY3JlYXRlVXBkYXRlTW9kYWxCdG4oKTtcclxuICAgIH1cclxuICBcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNsb3NlTW9kYWxCdG4oKXtcclxuICAgICAgLy8gQ2xvc2UgbW9kYWwgd2hlbiB0aGUgY2xvc2UgYnV0dG9uIGlzIGNsaWNrZWRcclxuICAgICAgY29uc3QgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgY2xvc2VCdXR0b24uY2xhc3NOYW1lID0gJ2Nsb3NlJztcclxuICAgICAgY2xvc2VCdXR0b24uaW5uZXJIVE1MID0gJyZ0aW1lczsnO1xyXG5cclxuICAgICAgLy8gQXR0YWNoIHRoZSBldmVudCBsaXN0ZW5lciB0byBjbG9zZSB0aGUgbW9kYWxcclxuICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBjbG9zZU1vZGFsKCkpO1xyXG5cclxuICAgICAgLy8gQXBwZW5kIHRoZSBjbG9zZSBidXR0b24gdG8gdGhlIG1vZGFsIGNvbnRlbnRcclxuICAgICAgbW9kYWxDb250ZW50LmFwcGVuZENoaWxkKGNsb3NlQnV0dG9uKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gRnVuY3Rpb24gdG8gY2xvc2UgdGhlIG1vZGFsXHJcbiAgICBmdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xyXG4gICAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICBcclxuICAgICAgbW9kYWxDb250ZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICBcclxuICAgIH1cclxuICBcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZVVwZGF0ZU1vZGFsQnRuICgpe1xyXG4gICAgICAvLyBPcHRpb25hbDogQWRkIGZ1bmN0aW9uYWxpdHkgdG8gdXBkYXRlIG9yIGRlbGV0ZSB0b2RvIGluIHRoZSBtb2RhbFxyXG4gICAgICBjb25zdCB1cGRhdGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgdXBkYXRlQnRuLnRleHRDb250ZW50ID0gJ1VwZGF0ZSc7XHJcbiAgICAgIHVwZGF0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHVwZGF0ZVRvZG9EZXRhaWxzKGluZGV4KSk7XHJcbiAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZCh1cGRhdGVCdG4pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0b2RvIGRldGFpbHMgKG9wdGlvbmFsKVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlVG9kb0RldGFpbHMoaW5kZXgpIHtcclxuICAgICAgLy8gQWRkIHlvdXIgbG9naWMgdG8gdXBkYXRlIHRvZG8gZGV0YWlsc1xyXG4gICAgICAvLyBZb3UgY2FuIHVzZSBwcm9tcHQsIGlucHV0IGZpZWxkcywgb3IgYW5vdGhlciBtb2RhbCBmb3IgdXBkYXRpbmdcclxuICAgICAgLy8gVGhlbiB1cGRhdGUgdGhlIHNlY3Rpb25zIGFycmF5IGFuZCBjbG9zZSB0aGUgbW9kYWxcclxuICAgICAgY2xvc2VNb2RhbCgpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgXHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIHBvcHVsYXRlU2VjdGlvbihzZWN0aW9uSWQsIHRvZG8pIHtcclxuICAgICAgc2VjdGlvbnMuZmluZChzZWN0aW9uID0+IHNlY3Rpb24uaWQgPT09IHNlY3Rpb25JZCkudG9kb3MucHVzaCh0b2RvKTtcclxuICAgIFxyXG4gICAgICAvLyBSZWZyZXNoIHRoZSBuYXZpZ2F0aW9uIGFuZCBjb250ZW50IHRvIHNlZSB0aGUgY2hhbmdlc1xyXG4gICAgICByZW5kZXJOYXZpZ2F0aW9uKCk7XHJcbiAgICAgIHNob3dDb250ZW50KHNlY3Rpb25zLmZpbmQoc2VjdGlvbiA9PiBzZWN0aW9uLmlkID09PSBzZWN0aW9uSWQpKTtcclxuICAgIH1cclxuICBcclxuXHJcbiAgcmVuZGVyTmF2aWdhdGlvbigpO1xyXG4gIHNob3dDb250ZW50KHNlY3Rpb25zLmZpbmQoc2VjdGlvbiA9PiBzZWN0aW9uLmlkID09PSAnQWxsIHRvZG9zJykpO1xyXG5cclxuICByZXR1cm57XHJcbiAgICByZW5kZXJOYXZpZ2F0aW9uLFxyXG4gICAgc2hvd0NvbnRlbnQsXHJcbiAgICBvcGVuVG9kb0RldGFpbHNNb2RhbCxcclxuICAgIGNsb3NlTW9kYWwsXHJcbiAgICBwb3B1bGF0ZVNlY3Rpb25cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgZG9tTG9hZGVyLFxyXG4gIHNlY3Rpb25zLFxyXG59IiwiaW1wb3J0IHsgVG9kb0ZhY3RvcnksIFByb2plY3RGYWN0b3J5IH0gZnJvbSBcIi4vZmFjdG9yaWVzXCI7XHJcbmltcG9ydCB7IGRvbUxvYWRlcixzZWN0aW9ucyxyZW5kZXJOYXZpZ2F0aW9uIH0gZnJvbSBcIi4vVUlcIjtcclxuXHJcbi8vIGkgbmVlZCB0byB3aHJpdGUgbG9jYWwgc3RvcmFnZSBmdW5jdGlvbnMsIHBlZ2hhcHMgaW4gZGlmZmVyZW50IG1vZHVsZVxyXG4vLyBhZGQgZGF0ZS1mbnNcclxuLy8gY3JlYXRlIG9yIGZpbmQgdGhlIFVJOiBcclxuLy8gZXhwYW5kIHRoZSBmYWN0b3JpZXMgd2l0aCB0aGUgbG9jYWwgc3RvcmFnZSBmdW5jdGlvbnMoZGVsZXRlLGFkZCxnZXQpXHJcbi8vIGNyZWF0ZSBvbmxvYWQgZnVuY3Rpb24gd2l0aCBhbGwgZ2V0IGZyb20gbG9jYWwgc3RvcmFnZVxyXG4vLyBsZWFybiBob3cgdG8gZXhwYW5kIHRvZG8gdG8gc2VlL2VkaXQgaXRzIGRldGFpbHNcclxuLy8gdmlldyBhbGwgdG9kb3MgaW4gZWFjaCBwcm9qZWN0IChwcm9iYWJseSBqdXN0IHRoZSB0aXRsZSBhbmQgZHVlZGF0ZeKApiBwZXJoYXBzIGNoYW5naW5nIGNvbG9yIGZvciBkaWZmZXJlbnQgcHJpb3JpdGllcylcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBkb21Mb2FkZXIoKTtcclxuICAgIC8vIHJlbmRlck5hdmlnYXRpb24oKVxyXG4gICB9KTtcclxuICBcclxuICAgIl0sIm5hbWVzIjpbIlRvZG9GYWN0b3J5IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcmlvcml0eSIsImNvbXBsaXRlIiwic2VjdGlvbnMiLCJpZCIsInRvZG9zIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwibmF2aWdhdGlvbiIsImdldEVsZW1lbnRCeUlkIiwiY29udGVudCIsIm1vZGFsIiwibW9kYWxDb250ZW50Iiwic2VjdGlvblRpdGxlIiwiY3JlYXRlQW5kQXBwZW5kRWxlbWVudCIsInJlbmRlck5hdmlnYXRpb24iLCJpbm5lckhUTUwiLCJzdHlsZSIsImRpc3BsYXkiLCJzZWN0aW9uRm9ybSIsIm5ld1NlY3Rpb24iLCJhZGRUb2RvIiwidG9kbyIsInB1c2giLCJkZWxldGVUb2RvIiwidG9kb0luZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsIlNlY3Rpb25GYWN0b3J5IiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwiY2xvc2VNb2RhbCIsInNob3dDb250ZW50IiwiZmluZCIsInNlY3Rpb24iLCJjcmVhdGVDbG9zZU1vZGFsQnRuIiwib3BlblNlY3Rpb25DcmVhdGVNb2RhbCIsImZvckVhY2giLCJpdGVtIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJjaGlsZHJlbiIsImNoaWxkIiwiY29udGVudEVsZW1lbnQiLCJhZGRUb2RvQnV0dG9uIiwidHlwZSIsIm1vZGFsVGl0bGUiLCJ0b2RvRm9ybSIsInRvZG9UaXRsZSIsInRvZG9EZXNjcmlwdGlvbiIsInRvZG9EdWVEYXRlIiwidG9kb1ByaW9yaXR5IiwidGV4dCIsIm5ld1RvZG8iLCJwb3B1bGF0ZVNlY3Rpb24iLCJjcmVhdGVVcGRhdGVNb2RhbEJ0biIsIm9wZW5Ub2RvQ3JlYXRlTW9kYWwiLCJsZW5ndGgiLCJub1RvZG9zTWVzc2FnZSIsImluZGV4IiwidG9kb0NvbnRhaW5lciIsImNoZWNrYm94IiwiY2hlY2tlZCIsImNvbXBsZXRlIiwidG9kb0VsZW1lbnQiLCJyZW1vdmUiLCJvcGVuVG9kb0RldGFpbHNNb2RhbCIsIm5hbWUiLCJwYXJlbnRFbCIsImxhYmVsVGV4dCIsIm9wdGlvbnMiLCJlbGVtZW50Iiwic2V0QXR0cmlidXRlIiwibGFiZWwiLCJvcHRpb24iLCJvcHRpb25FbGVtZW50IiwiY2xvc2VCdXR0b24iLCJjbGFzc05hbWUiLCJ1cGRhdGVCdG4iLCJzZWN0aW9uSWQiLCJkb21Mb2FkZXIiXSwic291cmNlUm9vdCI6IiJ9